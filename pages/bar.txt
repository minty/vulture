<h1>hello world</h1>

<input id=join  type=button value=join>
<input id=leave type=button value=leave>
<input id=work  type=button value=work>

<ul>
  <li>tell server we're done</li>
  <li>alert</li>
  <li>repeat</li>
</ul>

<script type="text/javascript">
  $(function() {

    $('#work').on('click', function(e) {
        $.ajax('/api/task/get', {
            'success': function(data) {
                $('.autoscript').remove();
                var script = $('<script class=autoscript type="text/javascript"><' + '/script>');
                script.text( data.run.task.test );
                $('body').append(script);
            }
        });
    });

    $('#join').on('click', function(e) {
        $.ajax('/api/client/join/', {
            'success': function(data) {
                if (typeof data.joined != 'undefined') {
                    alert('joined');
                }
                else {
                    alert('failed');
                }
            }
        });
    });

    $('#leave').on('click', function(e) {
        $.ajax('/api/client/leave/', {
            'success': function(data) {
                if (typeof data.left != 'undefined') {
                    alert('left');
                }
                else {
                    alert('failed to leave');
                }
            }
        });
    });
  });
</script>
